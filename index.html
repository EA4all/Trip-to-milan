<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <title>Firebase v12 Test</title>
</head>
<body>
    <h1>בדיקת Firestore v12</h1>
    <button id="readBtn">קרא מסמך</button>
    <button id="writeBtn">כתוב מסמך</button>
    <pre id="output"></pre>

    <!-- Firebase SDK v12 -->
    <script type="module">
        // 1. Import מה-SDK של Firebase v12
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

        // 2. הגדרות הפרויקט שלך מ-Firebase
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // 3. אתחול האפליקציה וה-Firestore
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const output = document.getElementById("output");

        // 4. פונקציה לקריאת מסמך
        async function readDocument() {
            try {
                const docRef = doc(db, "testCollection", "testDoc");
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    output.textContent = "נתונים קיימים: " + JSON.stringify(docSnap.data(), null, 2);
                } else {
                    output.textContent = "המסמך לא קיים!";
                }
            } catch (error) {
                output.textContent = "שגיאה בקריאה: " + error;
            }
        }

        // 5. פונקציה לכתיבת מסמך
        async function writeDocument() {
            try {
                const docRef = doc(db, "testCollection", "testDoc");
                await setDoc(docRef, {
                    message: "שלום Firebase!",
                    timestamp: new Date()
                });
                output.textContent = "המסמך נכתב בהצלחה!";
            } catch (error) {
                output.textContent = "שגיאה בכתיבה: " + error;
            }
        }

        // 6. אפשרות לאזנה בזמן אמת (Realtime Updates)
        const docRef = doc(db, "testCollection", "testDoc");
        onSnapshot(docRef, (docSnap) => {
            if (docSnap.exists()) {
                console.log("Realtime Update:", docSnap.data());
            }
        });

        // 7. חיבור הכפתורים לפונקציות
        document.getElementById("readBtn").addEventListener("click", readDocument);
        document.getElementById("writeBtn").addEventListener("click", writeDocument);
    </script>
</body>
</html>
